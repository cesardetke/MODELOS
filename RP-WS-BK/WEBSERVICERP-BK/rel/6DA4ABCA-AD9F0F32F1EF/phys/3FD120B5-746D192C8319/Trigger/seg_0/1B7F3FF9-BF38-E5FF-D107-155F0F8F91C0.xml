<?xml version = '1.0' encoding = 'UTF-8'?>
<TriggerOraclev10g class="oracle.dbtools.crest.model.design.storage.oracle.v10g.TriggerOraclev10g" name="T_RP_MOD_NOVEDAD_8" directorySegmentName="seg_0" id="1B7F3FF9-BF38-E5FF-D107-155F0F8F91C0">
<sourceConnName>PROD</sourceConnName>
<sourceObjSchema>RAPIPAGO</sourceObjSchema>
<sourceObjName>T_RP_MOD_NOVEDAD_8</sourceObjName>
<createdBy>CDETKE</createdBy>
<createdTime>2022-01-04 18:03:25 UTC</createdTime>
<ownerDesignName>WEBSERVICERP-BK</ownerDesignName>
<actions>UPDATE</actions>
<body><![CDATA[DECLARE
   wNumerador  NUMBER;
   v_accion VARCHAR2(1) := NULL;
   v_campo  VARCHAR2(50);
   v_ant VARCHAR2(20) := NULL; 
   v_nvo VARCHAR2(20) := NULL;
   
BEGIN
    IF NVL(:OLD.IS_DELETED,0) != NVL(:NEW.IS_DELETED,0) THEN
       IF :NEW.IS_DELETED = 'Y' THEN
          IF :NEW.OPERACION IN ('EX', 'ET') THEN
            v_accion := 'I';
          ELSE 
            v_accion := 'B';
          END IF;
       ELSE
          IF :NEW.OPERACION IN ('EX', 'ET') THEN
            v_accion := 'E';
          ELSE 
            v_accion := 'A';
          END IF;
       END IF;
       
       v_campo := 'IS_DELETED';
       v_ant := :OLD.IS_DELETED;
       v_nvo := :NEW.IS_DELETED;
    ELSE
    
       IF NVL(:OLD.OPERACION,0) != NVL(:NEW.OPERACION,0) THEN
          v_accion := 'M';
          v_campo := 'OPERACION';
          v_ant := :OLD.OPERACION;
          v_nvo := :NEW.OPERACION;
       END IF;
    
       IF NVL(:OLD.TIPO_COBERTURA,0) != NVL(:NEW.TIPO_COBERTURA,0) THEN
          v_accion := 'M';
          v_campo := 'TIPO_COBERTURA';
          v_ant := :OLD.TIPO_COBERTURA;
          v_nvo := :NEW.TIPO_COBERTURA;          
       END IF;    
    
    END IF;
           
    IF v_accion IS NOT NULL THEN
       SELECT RAPIPAGO.RP_SQ_NOVEDAD_COBERTURA.NEXTVAL into wNUMERADOR FROM DUAL;  
     
       INSERT INTO RAPIPAGO.WS_COBERTURA_NOVEDADES
           (ID_NOVEDAD, ID_GRUPO, TABLA, ID_TABLA, ESTADO, ACCION, CAMPO, VALOR_ANT, VALOR_NVO)
       VALUES(wNumerador, 'EMPRESA', 'RP_EMPRESA_PUESTO_COBERTURA', :OLD.ID_EMPRESA_PUESTO_COBERTURA,'P',v_accion, v_campo, v_ant, v_nvo);
    END IF;
    
END;]]></body>
<triggerTime>AFTER</triggerTime>
<owner>C62C8F1E-2A53-0B75-10F9-F26CB65E46CC</owner>
<table>DE6E5B4B-FFB6-0F88-A422-E11F2BED41EB</table>
</TriggerOraclev10g>